// Copyright 2006 Google Inc.
window.CanvasRenderingContext2D||!function(){function e(e){var t=e.srcElement;switch(e.propertyName){case"width":t.style.width=t.attributes.width.nodeValue+"px",t.getContext().clearRect();break;case"height":t.style.height=t.attributes.height.nodeValue+"px",t.getContext().clearRect()}}function t(e){var t=e.srcElement;t.firstChild&&(t.firstChild.style.width=t.clientWidth+"px",t.firstChild.style.height=t.clientHeight+"px")}function n(){return[[1,0,0],[0,1,0],[0,0,1]]}function i(e,t){for(var i=n(),r=0;3>r;r++)for(var a=0;3>a;a++){for(var s=0,o=0;3>o;o++)s+=e[r][o]*t[o][a];i[r][a]=s}return i}function r(e,t){t.fillStyle=e.fillStyle,t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.shadowBlur=e.shadowBlur,t.shadowColor=e.shadowColor,t.shadowOffsetX=e.shadowOffsetX,t.shadowOffsetY=e.shadowOffsetY,t.strokeStyle=e.strokeStyle,t.arcScaleX_=e.arcScaleX_,t.arcScaleY_=e.arcScaleY_}function a(e){var t,n=1;if(e=String(e),"rgb"==e.substring(0,3)){var i=e.indexOf("(",3),r=e.indexOf(")",i+1),a=e.substring(i+1,r).split(",");t="#";for(var s=0;3>s;s++)t+=v[Number(a[s])];4==a.length&&"a"==e.substr(3,1)&&(n=a[3])}else t=e;return[t,n]}function s(e){switch(e){case"butt":return"flat";case"round":return"round";case"square":default:return"square"}}function o(e){this.m_=n(),this.mStack_=[],this.aStack_=[],this.currentPath_=[],this.strokeStyle="#000",this.fillStyle="#000",this.lineWidth=1,this.lineJoin="miter",this.lineCap="butt",this.miterLimit=1*p,this.globalAlpha=1,this.canvas=e;var t=e.ownerDocument.createElement("div");t.style.width=e.clientWidth+"px",t.style.height=e.clientHeight+"px",t.style.overflow="hidden",t.style.position="absolute",e.appendChild(t),this.element_=t,this.arcScaleX_=1,this.arcScaleY_=1}function l(e){this.type_=e,this.radius1_=0,this.radius2_=0,this.colors_=[],this.focus_={x:0,y:0}}function u(){}var c=Math,h=c.round,d=c.sin,f=c.cos,p=10,m=p/2,g={init:function(e){var t=e||document;if(/MSIE/.test(navigator.userAgent)&&!window.opera){var n=this;t.attachEvent("onreadystatechange",function(){n.init_(t)})}},init_:function(e){if("complete"==e.readyState){e.namespaces.g_vml_||e.namespaces.add("g_vml_","urn:schemas-microsoft-com:vml");var t=e.createStyleSheet();t.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}g_vml_\\:*{behavior:url(#default#VML)}";for(var n=e.getElementsByTagName("canvas"),i=0;i<n.length;i++)n[i].getContext||this.initElement(n[i])}},fixElement_:function(e){var t=e.outerHTML,n=e.ownerDocument.createElement(t);if("/>"!=t.slice(-2)){for(var i,r="/"+e.tagName;(i=e.nextSibling)&&i.tagName!=r;)i.removeNode();i&&i.removeNode()}return e.parentNode.replaceChild(n,e),n},initElement:function(n){n=this.fixElement_(n),n.getContext=function(){return this.context_?this.context_:this.context_=new o(this)},n.attachEvent("onpropertychange",e),n.attachEvent("onresize",t);var i=n.attributes;return i.width&&i.width.specified?n.style.width=i.width.nodeValue:n.width=n.clientWidth,i.height&&i.height.specified?n.style.height=i.height.nodeValue:n.height=n.clientHeight,n}};g.init();for(var v=[],b=0;16>b;b++)for(var y=0;16>y;y++)v[16*b+y]=b.toString(16)+y.toString(16);var w=o.prototype;w.clearRect=function(){this.element_.innerHTML="",this.currentPath_=[]},w.beginPath=function(){this.currentPath_=[]},w.moveTo=function(e,t){this.currentPath_.push({type:"moveTo",x:e,y:t}),this.currentX_=e,this.currentY_=t},w.lineTo=function(e,t){this.currentPath_.push({type:"lineTo",x:e,y:t}),this.currentX_=e,this.currentY_=t},w.bezierCurveTo=function(e,t,n,i,r,a){this.currentPath_.push({type:"bezierCurveTo",cp1x:e,cp1y:t,cp2x:n,cp2y:i,x:r,y:a}),this.currentX_=r,this.currentY_=a},w.quadraticCurveTo=function(e,t,n,i){var r=this.currentX_+2/3*(e-this.currentX_),a=this.currentY_+2/3*(t-this.currentY_),s=r+(n-this.currentX_)/3,o=a+(i-this.currentY_)/3;this.bezierCurveTo(r,a,s,o,n,i)},w.arc=function(e,t,n,i,r,a){n*=p;var s=a?"at":"wa",o=e+f(i)*n-m,l=t+d(i)*n-m,u=e+f(r)*n-m,c=t+d(r)*n-m;o!=u||a||(o+=.125),this.currentPath_.push({type:s,x:e,y:t,radius:n,xStart:o,yStart:l,xEnd:u,yEnd:c})},w.rect=function(e,t,n,i){this.moveTo(e,t),this.lineTo(e+n,t),this.lineTo(e+n,t+i),this.lineTo(e,t+i),this.closePath()},w.strokeRect=function(e,t,n,i){this.beginPath(),this.moveTo(e,t),this.lineTo(e+n,t),this.lineTo(e+n,t+i),this.lineTo(e,t+i),this.closePath(),this.stroke()},w.fillRect=function(e,t,n,i){this.beginPath(),this.moveTo(e,t),this.lineTo(e+n,t),this.lineTo(e+n,t+i),this.lineTo(e,t+i),this.closePath(),this.fill()},w.createLinearGradient=function(){var e=new l("gradient");return e},w.createRadialGradient=function(e,t,n,i,r,a){var s=new l("gradientradial");return s.radius1_=n,s.radius2_=a,s.focus_.x=e,s.focus_.y=t,s},w.drawImage=function(e){var t,n,i,r,a,s,o,l,u=e.runtimeStyle.width,c=e.runtimeStyle.height;e.runtimeStyle.width="auto",e.runtimeStyle.height="auto";var d=e.width,f=e.height;if(e.runtimeStyle.width=u,e.runtimeStyle.height=c,3==arguments.length)t=arguments[1],n=arguments[2],a=s=0,o=i=d,l=r=f;else if(5==arguments.length)t=arguments[1],n=arguments[2],i=arguments[3],r=arguments[4],a=s=0,o=d,l=f;else{if(9!=arguments.length)throw"Invalid number of arguments";a=arguments[1],s=arguments[2],o=arguments[3],l=arguments[4],t=arguments[5],n=arguments[6],i=arguments[7],r=arguments[8]}var m=this.getCoords_(t,n),g=[],v=10,b=10;if(g.push(" <g_vml_:group",' coordsize="',p*v,",",p*b,'"',' coordorigin="0,0"',' style="width:',v,";height:",b,";position:absolute;"),1!=this.m_[0][0]||this.m_[0][1]){var y=[];y.push("M11='",this.m_[0][0],"',","M12='",this.m_[1][0],"',","M21='",this.m_[0][1],"',","M22='",this.m_[1][1],"',","Dx='",h(m.x/p),"',","Dy='",h(m.y/p),"'");var w=m,_=this.getCoords_(t+i,n),x=this.getCoords_(t,n+r),k=this.getCoords_(t+i,n+r);w.x=Math.max(w.x,_.x,x.x,k.x),w.y=Math.max(w.y,_.y,x.y,k.y),g.push("padding:0 ",h(w.x/p),"px ",h(w.y/p),"px 0;filter:progid:DXImageTransform.Microsoft.Matrix(",y.join(""),", sizingmethod='clip');")}else g.push("top:",h(m.y/p),"px;left:",h(m.x/p),"px;");g.push(' ">','<g_vml_:image src="',e.src,'"',' style="width:',p*i,";"," height:",p*r,';"',' cropleft="',a/d,'"',' croptop="',s/f,'"',' cropright="',(d-a-o)/d,'"',' cropbottom="',(f-s-l)/f,'"'," />","</g_vml_:group>"),this.element_.insertAdjacentHTML("BeforeEnd",g.join(""))},w.stroke=function(e){var t=[],n=a(e?this.fillStyle:this.strokeStyle),i=n[0],r=n[1]*this.globalAlpha,o=10,l=10;t.push("<g_vml_:shape",' fillcolor="',i,'"',' filled="',Boolean(e),'"',' style="position:absolute;width:',o,";height:",l,';"',' coordorigin="0 0" coordsize="',p*o," ",p*l,'"',' stroked="',!e,'"',' strokeweight="',this.lineWidth,'"',' strokecolor="',i,'"',' path="');for(var u={x:null,y:null},c={x:null,y:null},d=0;d<this.currentPath_.length;d++){var f=this.currentPath_[d];if("moveTo"==f.type){t.push(" m ");var m=this.getCoords_(f.x,f.y);t.push(h(m.x),",",h(m.y))}else if("lineTo"==f.type){t.push(" l ");var m=this.getCoords_(f.x,f.y);t.push(h(m.x),",",h(m.y))}else if("close"==f.type)t.push(" x ");else if("bezierCurveTo"==f.type){t.push(" c ");var m=this.getCoords_(f.x,f.y),g=this.getCoords_(f.cp1x,f.cp1y),v=this.getCoords_(f.cp2x,f.cp2y);t.push(h(g.x),",",h(g.y),",",h(v.x),",",h(v.y),",",h(m.x),",",h(m.y))}else if("at"==f.type||"wa"==f.type){t.push(" ",f.type," ");var m=this.getCoords_(f.x,f.y),b=this.getCoords_(f.xStart,f.yStart),y=this.getCoords_(f.xEnd,f.yEnd);t.push(h(m.x-this.arcScaleX_*f.radius),",",h(m.y-this.arcScaleY_*f.radius)," ",h(m.x+this.arcScaleX_*f.radius),",",h(m.y+this.arcScaleY_*f.radius)," ",h(b.x),",",h(b.y)," ",h(y.x),",",h(y.y))}m&&((null==u.x||m.x<u.x)&&(u.x=m.x),(null==c.x||m.x>c.x)&&(c.x=m.x),(null==u.y||m.y<u.y)&&(u.y=m.y),(null==c.y||m.y>c.y)&&(c.y=m.y))}if(t.push(' ">'),"object"==typeof this.fillStyle){var w={x:"50%",y:"50%"},_=c.x-u.x,x=c.y-u.y,k=_>x?_:x;w.x=h(this.fillStyle.focus_.x/_*100+50)+"%",w.y=h(this.fillStyle.focus_.y/x*100+50)+"%";var C=[];if("gradientradial"==this.fillStyle.type_)var S=this.fillStyle.radius1_/k*100,T=this.fillStyle.radius2_/k*100-S;else var S=0,T=100;var M={offset:null,color:null},E={offset:null,color:null};this.fillStyle.colors_.sort(function(e,t){return e.offset-t.offset});for(var d=0;d<this.fillStyle.colors_.length;d++){var j=this.fillStyle.colors_[d];C.push(j.offset*T+S,"% ",j.color,","),(j.offset>M.offset||null==M.offset)&&(M.offset=j.offset,M.color=j.color),(j.offset<E.offset||null==E.offset)&&(E.offset=j.offset,E.color=j.color)}C.pop(),t.push("<g_vml_:fill",' color="',E.color,'"',' color2="',M.color,'"',' type="',this.fillStyle.type_,'"',' focusposition="',w.x,", ",w.y,'"',' colors="',C.join(""),'"',' opacity="',r,'" />')}else e?t.push('<g_vml_:fill color="',i,'" opacity="',r,'" />'):t.push("<g_vml_:stroke",' opacity="',r,'"',' joinstyle="',this.lineJoin,'"',' miterlimit="',this.miterLimit,'"',' endcap="',s(this.lineCap),'"',' weight="',this.lineWidth,'px"',' color="',i,'" />');t.push("</g_vml_:shape>"),this.element_.insertAdjacentHTML("beforeEnd",t.join("")),this.currentPath_=[]},w.fill=function(){this.stroke(!0)},w.closePath=function(){this.currentPath_.push({type:"close"})},w.getCoords_=function(e,t){return{x:p*(e*this.m_[0][0]+t*this.m_[1][0]+this.m_[2][0])-m,y:p*(e*this.m_[0][1]+t*this.m_[1][1]+this.m_[2][1])-m}},w.save=function(){var e={};r(this,e),this.aStack_.push(e),this.mStack_.push(this.m_),this.m_=i(n(),this.m_)},w.restore=function(){r(this.aStack_.pop(),this),this.m_=this.mStack_.pop()},w.translate=function(e,t){var n=[[1,0,0],[0,1,0],[e,t,1]];this.m_=i(n,this.m_)},w.rotate=function(e){var t=f(e),n=d(e),r=[[t,n,0],[-n,t,0],[0,0,1]];this.m_=i(r,this.m_)},w.scale=function(e,t){this.arcScaleX_*=e,this.arcScaleY_*=t;var n=[[e,0,0],[0,t,0],[0,0,1]];this.m_=i(n,this.m_)},w.clip=function(){},w.arcTo=function(){},w.createPattern=function(){return new u},l.prototype.addColorStop=function(e,t){t=a(t),this.colors_.push({offset:1-e,color:t})},G_vmlCanvasManager=g,CanvasRenderingContext2D=o,CanvasGradient=l,CanvasPattern=u}();