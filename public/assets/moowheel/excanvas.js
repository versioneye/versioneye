// Copyright 2006 Google Inc.
window.CanvasRenderingContext2D||!function(){function e(e){var t=e.srcElement;switch(e.propertyName){case"width":t.style.width=t.attributes.width.nodeValue+"px",t.getContext().clearRect();break;case"height":t.style.height=t.attributes.height.nodeValue+"px",t.getContext().clearRect()}}function t(e){var t=e.srcElement;t.firstChild&&(t.firstChild.style.width=t.clientWidth+"px",t.firstChild.style.height=t.clientHeight+"px")}function n(){return[[1,0,0],[0,1,0],[0,0,1]]}function i(e,t){for(var i=n(),a=0;3>a;a++)for(var r=0;3>r;r++){for(var o=0,s=0;3>s;s++)o+=e[a][s]*t[s][r];i[a][r]=o}return i}function a(e,t){t.fillStyle=e.fillStyle,t.lineCap=e.lineCap,t.lineJoin=e.lineJoin,t.lineWidth=e.lineWidth,t.miterLimit=e.miterLimit,t.shadowBlur=e.shadowBlur,t.shadowColor=e.shadowColor,t.shadowOffsetX=e.shadowOffsetX,t.shadowOffsetY=e.shadowOffsetY,t.strokeStyle=e.strokeStyle,t.arcScaleX_=e.arcScaleX_,t.arcScaleY_=e.arcScaleY_}function r(e){var t,n=1;if(e=String(e),"rgb"==e.substring(0,3)){var i=e.indexOf("(",3),a=e.indexOf(")",i+1),r=e.substring(i+1,a).split(",");t="#";for(var o=0;3>o;o++)t+=b[Number(r[o])];4==r.length&&"a"==e.substr(3,1)&&(n=r[3])}else t=e;return[t,n]}function o(e){switch(e){case"butt":return"flat";case"round":return"round";case"square":default:return"square"}}function s(e){this.m_=n(),this.mStack_=[],this.aStack_=[],this.currentPath_=[],this.strokeStyle="#000",this.fillStyle="#000",this.lineWidth=1,this.lineJoin="miter",this.lineCap="butt",this.miterLimit=1*p,this.globalAlpha=1,this.canvas=e;var t=e.ownerDocument.createElement("div");t.style.width=e.clientWidth+"px",t.style.height=e.clientHeight+"px",t.style.overflow="hidden",t.style.position="absolute",e.appendChild(t),this.element_=t,this.arcScaleX_=1,this.arcScaleY_=1}function l(e){this.type_=e,this.radius1_=0,this.radius2_=0,this.colors_=[],this.focus_={x:0,y:0}}function u(){}var c=Math,h=c.round,f=c.sin,d=c.cos,p=10,m=p/2,g={init:function(e){var t=e||document;if(/MSIE/.test(navigator.userAgent)&&!window.opera){var n=this;t.attachEvent("onreadystatechange",function(){n.init_(t)})}},init_:function(e){if("complete"==e.readyState){e.namespaces.g_vml_||e.namespaces.add("g_vml_","urn:schemas-microsoft-com:vml");var t=e.createStyleSheet();t.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}g_vml_\\:*{behavior:url(#default#VML)}";for(var n=e.getElementsByTagName("canvas"),i=0;i<n.length;i++)n[i].getContext||this.initElement(n[i])}},fixElement_:function(e){var t=e.outerHTML,n=e.ownerDocument.createElement(t);if("/>"!=t.slice(-2)){for(var i,a="/"+e.tagName;(i=e.nextSibling)&&i.tagName!=a;)i.removeNode();i&&i.removeNode()}return e.parentNode.replaceChild(n,e),n},initElement:function(n){n=this.fixElement_(n),n.getContext=function(){return this.context_?this.context_:this.context_=new s(this)},n.attachEvent("onpropertychange",e),n.attachEvent("onresize",t);var i=n.attributes;return i.width&&i.width.specified?n.style.width=i.width.nodeValue:n.width=n.clientWidth,i.height&&i.height.specified?n.style.height=i.height.nodeValue:n.height=n.clientHeight,n}};g.init();for(var b=[],v=0;16>v;v++)for(var y=0;16>y;y++)b[16*v+y]=v.toString(16)+y.toString(16);var w=s.prototype;w.clearRect=function(){this.element_.innerHTML="",this.currentPath_=[]},w.beginPath=function(){this.currentPath_=[]},w.moveTo=function(e,t){this.currentPath_.push({type:"moveTo",x:e,y:t}),this.currentX_=e,this.currentY_=t},w.lineTo=function(e,t){this.currentPath_.push({type:"lineTo",x:e,y:t}),this.currentX_=e,this.currentY_=t},w.bezierCurveTo=function(e,t,n,i,a,r){this.currentPath_.push({type:"bezierCurveTo",cp1x:e,cp1y:t,cp2x:n,cp2y:i,x:a,y:r}),this.currentX_=a,this.currentY_=r},w.quadraticCurveTo=function(e,t,n,i){var a=this.currentX_+2/3*(e-this.currentX_),r=this.currentY_+2/3*(t-this.currentY_),o=a+(n-this.currentX_)/3,s=r+(i-this.currentY_)/3;this.bezierCurveTo(a,r,o,s,n,i)},w.arc=function(e,t,n,i,a,r){n*=p;var o=r?"at":"wa",s=e+d(i)*n-m,l=t+f(i)*n-m,u=e+d(a)*n-m,c=t+f(a)*n-m;s!=u||r||(s+=.125),this.currentPath_.push({type:o,x:e,y:t,radius:n,xStart:s,yStart:l,xEnd:u,yEnd:c})},w.rect=function(e,t,n,i){this.moveTo(e,t),this.lineTo(e+n,t),this.lineTo(e+n,t+i),this.lineTo(e,t+i),this.closePath()},w.strokeRect=function(e,t,n,i){this.beginPath(),this.moveTo(e,t),this.lineTo(e+n,t),this.lineTo(e+n,t+i),this.lineTo(e,t+i),this.closePath(),this.stroke()},w.fillRect=function(e,t,n,i){this.beginPath(),this.moveTo(e,t),this.lineTo(e+n,t),this.lineTo(e+n,t+i),this.lineTo(e,t+i),this.closePath(),this.fill()},w.createLinearGradient=function(){var e=new l("gradient");return e},w.createRadialGradient=function(e,t,n,i,a,r){var o=new l("gradientradial");return o.radius1_=n,o.radius2_=r,o.focus_.x=e,o.focus_.y=t,o},w.drawImage=function(e){var t,n,i,a,r,o,s,l,u=e.runtimeStyle.width,c=e.runtimeStyle.height;e.runtimeStyle.width="auto",e.runtimeStyle.height="auto";var f=e.width,d=e.height;if(e.runtimeStyle.width=u,e.runtimeStyle.height=c,3==arguments.length)t=arguments[1],n=arguments[2],r=o=0,s=i=f,l=a=d;else if(5==arguments.length)t=arguments[1],n=arguments[2],i=arguments[3],a=arguments[4],r=o=0,s=f,l=d;else{if(9!=arguments.length)throw"Invalid number of arguments";r=arguments[1],o=arguments[2],s=arguments[3],l=arguments[4],t=arguments[5],n=arguments[6],i=arguments[7],a=arguments[8]}var m=this.getCoords_(t,n),g=[],b=10,v=10;if(g.push(" <g_vml_:group",' coordsize="',p*b,",",p*v,'"',' coordorigin="0,0"',' style="width:',b,";height:",v,";position:absolute;"),1!=this.m_[0][0]||this.m_[0][1]){var y=[];y.push("M11='",this.m_[0][0],"',","M12='",this.m_[1][0],"',","M21='",this.m_[0][1],"',","M22='",this.m_[1][1],"',","Dx='",h(m.x/p),"',","Dy='",h(m.y/p),"'");var w=m,_=this.getCoords_(t+i,n),x=this.getCoords_(t,n+a),k=this.getCoords_(t+i,n+a);w.x=Math.max(w.x,_.x,x.x,k.x),w.y=Math.max(w.y,_.y,x.y,k.y),g.push("padding:0 ",h(w.x/p),"px ",h(w.y/p),"px 0;filter:progid:DXImageTransform.Microsoft.Matrix(",y.join(""),", sizingmethod='clip');")}else g.push("top:",h(m.y/p),"px;left:",h(m.x/p),"px;");g.push(' ">','<g_vml_:image src="',e.src,'"',' style="width:',p*i,";"," height:",p*a,';"',' cropleft="',r/f,'"',' croptop="',o/d,'"',' cropright="',(f-r-s)/f,'"',' cropbottom="',(d-o-l)/d,'"'," />","</g_vml_:group>"),this.element_.insertAdjacentHTML("BeforeEnd",g.join(""))},w.stroke=function(e){var t=[],n=r(e?this.fillStyle:this.strokeStyle),i=n[0],a=n[1]*this.globalAlpha,s=10,l=10;t.push("<g_vml_:shape",' fillcolor="',i,'"',' filled="',Boolean(e),'"',' style="position:absolute;width:',s,";height:",l,';"',' coordorigin="0 0" coordsize="',p*s," ",p*l,'"',' stroked="',!e,'"',' strokeweight="',this.lineWidth,'"',' strokecolor="',i,'"',' path="');for(var u={x:null,y:null},c={x:null,y:null},f=0;f<this.currentPath_.length;f++){var d=this.currentPath_[f];if("moveTo"==d.type){t.push(" m ");var m=this.getCoords_(d.x,d.y);t.push(h(m.x),",",h(m.y))}else if("lineTo"==d.type){t.push(" l ");var m=this.getCoords_(d.x,d.y);t.push(h(m.x),",",h(m.y))}else if("close"==d.type)t.push(" x ");else if("bezierCurveTo"==d.type){t.push(" c ");var m=this.getCoords_(d.x,d.y),g=this.getCoords_(d.cp1x,d.cp1y),b=this.getCoords_(d.cp2x,d.cp2y);t.push(h(g.x),",",h(g.y),",",h(b.x),",",h(b.y),",",h(m.x),",",h(m.y))}else if("at"==d.type||"wa"==d.type){t.push(" ",d.type," ");var m=this.getCoords_(d.x,d.y),v=this.getCoords_(d.xStart,d.yStart),y=this.getCoords_(d.xEnd,d.yEnd);t.push(h(m.x-this.arcScaleX_*d.radius),",",h(m.y-this.arcScaleY_*d.radius)," ",h(m.x+this.arcScaleX_*d.radius),",",h(m.y+this.arcScaleY_*d.radius)," ",h(v.x),",",h(v.y)," ",h(y.x),",",h(y.y))}m&&((null==u.x||m.x<u.x)&&(u.x=m.x),(null==c.x||m.x>c.x)&&(c.x=m.x),(null==u.y||m.y<u.y)&&(u.y=m.y),(null==c.y||m.y>c.y)&&(c.y=m.y))}if(t.push(' ">'),"object"==typeof this.fillStyle){var w={x:"50%",y:"50%"},_=c.x-u.x,x=c.y-u.y,k=_>x?_:x;w.x=h(this.fillStyle.focus_.x/_*100+50)+"%",w.y=h(this.fillStyle.focus_.y/x*100+50)+"%";var C=[];if("gradientradial"==this.fillStyle.type_)var S=this.fillStyle.radius1_/k*100,j=this.fillStyle.radius2_/k*100-S;else var S=0,j=100;var M={offset:null,color:null},F={offset:null,color:null};this.fillStyle.colors_.sort(function(e,t){return e.offset-t.offset});for(var f=0;f<this.fillStyle.colors_.length;f++){var T=this.fillStyle.colors_[f];C.push(T.offset*j+S,"% ",T.color,","),(T.offset>M.offset||null==M.offset)&&(M.offset=T.offset,M.color=T.color),(T.offset<F.offset||null==F.offset)&&(F.offset=T.offset,F.color=T.color)}C.pop(),t.push("<g_vml_:fill",' color="',F.color,'"',' color2="',M.color,'"',' type="',this.fillStyle.type_,'"',' focusposition="',w.x,", ",w.y,'"',' colors="',C.join(""),'"',' opacity="',a,'" />')}else e?t.push('<g_vml_:fill color="',i,'" opacity="',a,'" />'):t.push("<g_vml_:stroke",' opacity="',a,'"',' joinstyle="',this.lineJoin,'"',' miterlimit="',this.miterLimit,'"',' endcap="',o(this.lineCap),'"',' weight="',this.lineWidth,'px"',' color="',i,'" />');t.push("</g_vml_:shape>"),this.element_.insertAdjacentHTML("beforeEnd",t.join("")),this.currentPath_=[]},w.fill=function(){this.stroke(!0)},w.closePath=function(){this.currentPath_.push({type:"close"})},w.getCoords_=function(e,t){return{x:p*(e*this.m_[0][0]+t*this.m_[1][0]+this.m_[2][0])-m,y:p*(e*this.m_[0][1]+t*this.m_[1][1]+this.m_[2][1])-m}},w.save=function(){var e={};a(this,e),this.aStack_.push(e),this.mStack_.push(this.m_),this.m_=i(n(),this.m_)},w.restore=function(){a(this.aStack_.pop(),this),this.m_=this.mStack_.pop()},w.translate=function(e,t){var n=[[1,0,0],[0,1,0],[e,t,1]];this.m_=i(n,this.m_)},w.rotate=function(e){var t=d(e),n=f(e),a=[[t,n,0],[-n,t,0],[0,0,1]];this.m_=i(a,this.m_)},w.scale=function(e,t){this.arcScaleX_*=e,this.arcScaleY_*=t;var n=[[e,0,0],[0,t,0],[0,0,1]];this.m_=i(n,this.m_)},w.clip=function(){},w.arcTo=function(){},w.createPattern=function(){return new u},l.prototype.addColorStop=function(e,t){t=r(t),this.colors_.push({offset:1-e,color:t})},G_vmlCanvasManager=g,CanvasRenderingContext2D=s,CanvasGradient=l,CanvasPattern=u}();