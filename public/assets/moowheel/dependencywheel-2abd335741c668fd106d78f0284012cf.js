function show_info_box(t,e){box_name=e.infoBox,number_name=e.infoNumber,recursive_deps=t.length,e.data_length=t.length,info_box=document.getElementById(box_name),info_box&&(info_box.style.display="inline-block"),info_number=document.getElementById(number_name),info_number&&(info_number.innerHTML=recursive_deps),scope_name=document.getElementById("scope_name"),scope_name&&(scope_name.innerHTML="all"==e.scope?"":e.scope)}var DependencyWheel=new Class({options:{type:"default",center:{x:100,y:100},width:null,height:null,lines:{color:"random",lineWidth:2},imageSize:[24,24],radialMultiplier:3.47,hover:!0,hoverLines:{color:"rgba(255,255,255,255)",lineWidth:5},onItemClick:$empty,infoBox:"mooinfo",infoNumber:"moonumber",scope:"compile",data_border:70,canvas_id:"canvas",canvas_hover_id:"canvas_hover",product_key:"product_key",product_version:"product_version",product_name:"product_name",version:"version",show_label:!1,resize:!1,resize_ids:"container,section",resize_factor:11,container_id:"canvas-container",pinit:!0},initialize:function(t,e,n){if(this.data=t,data_length=t.length,this.radius=Math.round(this.options.radialMultiplier*data_length),this.setOptions(n),3>data_length&&(n.height="77",this.options.height="77",n.show_label=!1,this.options.show_label=!1),border=this.options.data_border,data_length>border&&0==this.options.resize)return show_info_box(t,n),!1;var i;if(!this.options.width||!this.options.height){for(var r=0,o=0;o<t.length;o++)t[o].text.length>r&&(r=t[o].text.length);i=2*(this.radius+8*r+this.options.imageSize[0])+12}e.empty(),e=$(e);var a=new Element("canvas",{width:(this.options.width?this.options.width:i)+"px",height:(this.options.height?this.options.height:i)+"px",id:this.options.canvas_id});e.adopt(a),"undefined"!=typeof G_vmlCanvasManager&&(a=$(G_vmlCanvasManager.initElement(a))),this.canvas=a,this.cx=a.getContext("2d"),this.maxCount=1;var s=this.canvas.getCoordinates();return this.options.center={x:s.width/2,y:s.height/2},CanvasTextFunctions.enable(this.cx),0==data_length?(this.cx.fillStyle="green",this.cx.font="42px Arial",this.cx.fillText("0",this.options.center.x-10,45),void show_info_box(this.data,this.options)):(this.options.hover&&(this.hoverCanvas=new Element("canvas",{styles:{position:"absolute",left:s.left+"px",top:s.top+"px",zIndex:9},id:this.options.canvas_hover_id,width:s.width+"px",height:s.height+"px"}),this.hoverCanvas.injectAfter(this.canvas),window.addEvent("resize",function(){var t=this.canvas.getCoordinates();this.hoverCanvas.setStyles({left:t.left+"px",top:t.top+"px"}),this.hoverCanvas.width=t.width,this.hoverCanvas.height=t.height}.bind(this)),"undefined"!=typeof G_vmlCanvasManager&&(this.hoverCanvas=$(G_vmlCanvasManager.initElement(this.hoverCanvas)))),this.data.each(function(t){t.connections.each(function(t){"array"==$type(t)&&t[1]>this.maxCount&&(this.maxCount=t[1])},this)},this),void this.draw())},setPoints:function(){this.points={},this.bboxes=[],this.numDegrees=360/this.data.length;for(var t=0,e=0;e<this.data.length;t+=this.numDegrees,e++)if(!this.data[e].colors){var n=(this.data[e],{});"random"==this.options.lines.color?(p1=100,p2=100,n.__default="rgba("+(Math.floor(Math.random()*p1)+p2)+","+(Math.floor(Math.random()*p1)+p2)+","+(Math.floor(Math.random()*p1)+p2)+", 1)"):n.__default=this.options.lines.color,this.data[e].colors=n}},pc:function(t){return 7*Math.round(t/7)},calcbbox:function(t,e,n,i){t=Number(t.toFixed(2)),e=Number(e.toFixed(2)),n=Number(n.toFixed(2));var r,o=this.options.center.x,a=this.options.center.y,s=(e-a)/(t-o),u={x:t-5*Math.cos((n+90)*(Math.PI/180)),y:e-5*Math.sin((n+90)*(Math.PI/180))},l=u.y-s*u.x;r=1/0==s||s==-1/0?function(t){return Math.abs(t-u.x)}:function(t,e){return Math.abs(s*t-e+l)/Math.sqrt(Math.pow(s,2)+1)};var c=this.cx.measureText("sans","10",this.data[i].text);c=Number(c.toFixed(2));var h,p={x:t+5*Math.cos((n+90)*(Math.PI/180)),y:e+5*Math.sin((n+90)*(Math.PI/180))},d=p.y-s*p.x;h=1/0==s||s==-1/0?function(t){return Math.abs(t-p.x)}:function(t,e){return Math.abs(s*t-e+d)/Math.sqrt(Math.pow(s,2)+1)},this.bboxes[i]=function(i,o){if(0==n&&0>i-t)return!1;if(n>0&&90>n&&0>i-t&&0>o-e)return!1;if(90==n&&0>o-e)return!1;if(n>90&&180>n&&i-t>0&&0>o-e)return!1;if(180==n&&i-t>0)return!1;if(n>180&&270>n&&i-t>0&&o-e>0)return!1;if(270==n&&o-e>0)return!1;if(n>270&&360>n&&0>i-t&&o-e>0)return!1;var a=Math.sqrt(Math.pow(i-t,2)+Math.pow(o-e,2)),s=r(i,o),u=h(i,o);return c+8>=a&&10>=s&&10>=u?!0:!1}},drawPoints:function(){for(var t=0,e=0;e<this.data.length;t+=this.numDegrees,e++){this.cx.beginPath(),this.cx.fillStyle=this.cx.strokeStyle=this.data[e].colors.__default;var n=this.options.center.x+Math.cos(t*(Math.PI/180))*this.radius,i=this.options.center.y+Math.sin(t*(Math.PI/180))*this.radius;this.cx.arc(n,i,4,0,2*Math.PI,0),this.cx.fill(),this.cx.closePath(),this.calcbbox(n,i,t,e),this.points[this.pc(n)]||(this.points[this.pc(n)]={}),this.points[this.pc(n)][this.pc(i)]=e,this.cx.save(),this.cx.translate(this.options.center.x,this.options.center.y),this.cx.rotate((t>90&&270>t?t-180:t)*(Math.PI/180));var r,o;t>90&&270>t?(r=-(this.radius+this.cx.measureText("sans","10",this.data[e].text+"")+8),o=r-30):(r=this.radius+8,o=r+6+this.cx.measureText("sans","10",this.data[e].text+"")),this.cx.drawText("sans","10",r,this.cx.fontAscent("sans","10")/2,this.data[e].text),this.data[e].image&&this.cx.drawImage($(this.data[e].image),o,-12,this.options.imageSize[0],this.options.imageSize[1]),this.cx.restore()}},getAngle:function(t){return t*(360/this.data.length)},getItemIdxById:function(t){"array"==$type(t)&&(t=t[0]);for(var e=0,n=this.data.length;n>e;e++)if(this.data[e].id==t)return e;return-1},drawConnection:function(t,e){e&&(document.getElementById(this.options.canvas_hover_id).style.top=document.getElementById(this.options.canvas_id).getCoordinates().top+"px");var n=e?this.hoverCanvas.getContext("2d"):this.cx,i=this.data[t],r=i.connections,o=this.getAngle(t),a=this.options.center.x+Math.cos(o*(Math.PI/180))*this.radius,s=this.options.center.y+Math.sin(o*(Math.PI/180))*this.radius;n.lineWidth=e?this.options.hoverLines.lineWidth:2;for(var u=0;u<r.length;u++){var l=this.getItemIdxById(r[u]),c=r[u],h=!(!i.dependencies||-1==i.dependencies.indexOf(c));n.beginPath(),n.moveTo(a,s),rpos=this.getAngle(l),x2=this.options.center.x+Math.cos(rpos*(Math.PI/180))*this.radius,y2=this.options.center.y+Math.sin(rpos*(Math.PI/180))*this.radius,cp1x=this.options.center.x+Math.cos(o*(Math.PI/180))*(this.radius/1.5),cp1y=this.options.center.y+Math.sin(o*(Math.PI/180))*(this.radius/1.5),cp2x=this.options.center.x+Math.cos(rpos*(Math.PI/180))*(this.radius/1.5),cp2y=this.options.center.y+Math.sin(rpos*(Math.PI/180))*(this.radius/1.5);var p=this.data[l];n.strokeStyle=e?this.getStrokeGradient(n,{x1:a,y1:s,c1:i.colors.__default,x2:x2,y2:y2,c2:p.colors.__default},h):i.colors[r[u][0]]?i.colors[r[u][0]]:i.colors.__default,n.beginPath(),n.moveTo(a,s),n.bezierCurveTo(cp1x,cp1y,cp2x,cp2y,x2,y2),n.stroke(),n.closePath()}if(!e)if(this.data[t+1]){var d=this;setTimeout(function(){d.drawConnection(t+1)},25)}else this.drawPoints(),this.options.show_label&&(n.fillStyle="lightgray",n.font="14px Arial",n.fillText("www.VersionEye.com",this.options.center.x-70,30)),show_info_box(this.data,this.options)},getStrokeGradient:function(t,e,n){var i=t.createLinearGradient(e.x1,e.y1,e.x2,e.y2);return n?(i.addColorStop(0,"rgba(0,0,127,0.5)"),i.addColorStop(1,"rgba(0,0,127,1)")):(i.addColorStop(0,"rgba(0,127,0,0.5)"),i.addColorStop(1,"rgba(0,127,0,1)")),i},draw:function(){this.data&&(this.setPoints(),this.drawConnection(0)),this.options.hover&&($(this.hoverCanvas).addEvent("mousemove",function(t){t=new Event(t);var e=$(this.hoverCanvas).getCoordinates(),n={x:t.page.x-e.left,y:t.page.y-e.top},i=function(t){var e={x:this.pc(t.x),y:this.pc(t.y)};if($defined(this.points[e.x])&&$defined(this.points[e.x][e.y]))return this.points[e.x][e.y];for(var n=0,i=this.bboxes.length;i>n;n++){var r=this.bboxes[n];if(r(t.x,t.y)===!0)return n}return!1}.bind(this),r=i(n);if(r!==!1){if(this.lastMouseOver==r)return;this.drawConnection(r,!0),this.lastMouseOver=r,this.canvas.setStyle("opacity","0.5"),this.hoverCanvas.setStyle("cursor","pointer")}else if($defined(this.lastMouseOver)){var o=this.hoverCanvas.getContext("2d");o.clearRect(0,0,e.width,e.height),o.save(),this.lastMouseOver=null,this.canvas.setStyle("opacity","1.0"),this.hoverCanvas.setStyle("cursor","default")}}.bind(this)),$(this.hoverCanvas).addEvent("click",function(t){this.options.onItemClick(this.data[this.lastMouseOver],t)}.bind(this)))},getTemperature:function(t,e){if("heat"==t){var n={r:e/.33,y:(e-.33)/.33,w:(e-.66)/.66},i=Math.round(255*n.r>255?255:255*n.r),r=Math.round(255*n.y>255?255:255*n.y),o=Math.round(255*n.w>255?255:255*n.w);return"rgba("+(0>i?0:i)+","+(0>r?0:r)+","+(0>o?0:o)+", "+(.8*e+.2)+")"}if("cold"==t){var i=Math.round(255*e),a=Math.round(130+125*e);return"rgba("+i+","+a+",255, "+(.8*e+.2)+")"}}});DependencyWheel.implement(new Options),DependencyWheel.Remote=new Class({Extends:DependencyWheel,initialize:function(t,e,n){var i=function(t){var i=[],r={};if(!t)return!1;if(border=n.data_border,t.length>border&&1==n.resize)for(n.width=t.length*n.resize_factor,n.height=t.length*n.resize_factor,element_ids=n.resize_ids.split(","),element_count=0;element_count<element_ids.length;element_count++)element=document.getElementById(element_ids[element_count]),new_width=n.width+20*element_count,element.offsetWidth<new_width&&(element.style.width=new_width+"px");for(var o=0,a=t.length;a>o;o++)t[o].imageUrl&&(i.push(t[o].imageUrl),r[o]=i.length-1);if(0==i.length)return!1;var s=new Asset.images(i,{onComplete:function(){for(var i in r)t[i].image=s[r[i]];arguments.callee._parent_=this.initialize._parent_,this.parent(t,e,n)}.bind(this)});return!0}.bind(this);n&&n.url?(json_url=n.url,new Request.JSON({url:json_url,onComplete:function(r){t=r,arguments.callee._parent_=this.initialize._parent_,i(t,e,n)||this.parent(t,e,n)}.bind(this)}).send()):i(t,e,n)||this.parent(t,e,n)}});