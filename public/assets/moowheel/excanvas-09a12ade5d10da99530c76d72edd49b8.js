// Copyright 2006 Google Inc.
window.CanvasRenderingContext2D||!function(){function t(t){var e=t.srcElement;switch(t.propertyName){case"width":e.style.width=e.attributes.width.nodeValue+"px",e.getContext().clearRect();break;case"height":e.style.height=e.attributes.height.nodeValue+"px",e.getContext().clearRect()}}function e(t){var e=t.srcElement;e.firstChild&&(e.firstChild.style.width=e.clientWidth+"px",e.firstChild.style.height=e.clientHeight+"px")}function n(){return[[1,0,0],[0,1,0],[0,0,1]]}function i(t,e){for(var i=n(),r=0;3>r;r++)for(var o=0;3>o;o++){for(var a=0,s=0;3>s;s++)a+=t[r][s]*e[s][o];i[r][o]=a}return i}function r(t,e){e.fillStyle=t.fillStyle,e.lineCap=t.lineCap,e.lineJoin=t.lineJoin,e.lineWidth=t.lineWidth,e.miterLimit=t.miterLimit,e.shadowBlur=t.shadowBlur,e.shadowColor=t.shadowColor,e.shadowOffsetX=t.shadowOffsetX,e.shadowOffsetY=t.shadowOffsetY,e.strokeStyle=t.strokeStyle,e.arcScaleX_=t.arcScaleX_,e.arcScaleY_=t.arcScaleY_}function o(t){var e,n=1;if(t=String(t),"rgb"==t.substring(0,3)){var i=t.indexOf("(",3),r=t.indexOf(")",i+1),o=t.substring(i+1,r).split(",");e="#";for(var a=0;3>a;a++)e+=v[Number(o[a])];4==o.length&&"a"==t.substr(3,1)&&(n=o[3])}else e=t;return[e,n]}function a(t){switch(t){case"butt":return"flat";case"round":return"round";case"square":default:return"square"}}function s(t){this.m_=n(),this.mStack_=[],this.aStack_=[],this.currentPath_=[],this.strokeStyle="#000",this.fillStyle="#000",this.lineWidth=1,this.lineJoin="miter",this.lineCap="butt",this.miterLimit=1*f,this.globalAlpha=1,this.canvas=t;var e=t.ownerDocument.createElement("div");e.style.width=t.clientWidth+"px",e.style.height=t.clientHeight+"px",e.style.overflow="hidden",e.style.position="absolute",t.appendChild(e),this.element_=e,this.arcScaleX_=1,this.arcScaleY_=1}function u(t){this.type_=t,this.radius1_=0,this.radius2_=0,this.colors_=[],this.focus_={x:0,y:0}}function l(){}var c=Math,h=c.round,p=c.sin,d=c.cos,f=10,m=f/2,g={init:function(t){var e=t||document;if(/MSIE/.test(navigator.userAgent)&&!window.opera){var n=this;e.attachEvent("onreadystatechange",function(){n.init_(e)})}},init_:function(t){if("complete"==t.readyState){t.namespaces.g_vml_||t.namespaces.add("g_vml_","urn:schemas-microsoft-com:vml");var e=t.createStyleSheet();e.cssText="canvas{display:inline-block;overflow:hidden;text-align:left;width:300px;height:150px}g_vml_\\:*{behavior:url(#default#VML)}";for(var n=t.getElementsByTagName("canvas"),i=0;i<n.length;i++)n[i].getContext||this.initElement(n[i])}},fixElement_:function(t){var e=t.outerHTML,n=t.ownerDocument.createElement(e);if("/>"!=e.slice(-2)){for(var i,r="/"+t.tagName;(i=t.nextSibling)&&i.tagName!=r;)i.removeNode();i&&i.removeNode()}return t.parentNode.replaceChild(n,t),n},initElement:function(n){n=this.fixElement_(n),n.getContext=function(){return this.context_?this.context_:this.context_=new s(this)},n.attachEvent("onpropertychange",t),n.attachEvent("onresize",e);var i=n.attributes;return i.width&&i.width.specified?n.style.width=i.width.nodeValue:n.width=n.clientWidth,i.height&&i.height.specified?n.style.height=i.height.nodeValue:n.height=n.clientHeight,n}};g.init();for(var v=[],y=0;16>y;y++)for(var b=0;16>b;b++)v[16*y+b]=y.toString(16)+b.toString(16);var w=s.prototype;w.clearRect=function(){this.element_.innerHTML="",this.currentPath_=[]},w.beginPath=function(){this.currentPath_=[]},w.moveTo=function(t,e){this.currentPath_.push({type:"moveTo",x:t,y:e}),this.currentX_=t,this.currentY_=e},w.lineTo=function(t,e){this.currentPath_.push({type:"lineTo",x:t,y:e}),this.currentX_=t,this.currentY_=e},w.bezierCurveTo=function(t,e,n,i,r,o){this.currentPath_.push({type:"bezierCurveTo",cp1x:t,cp1y:e,cp2x:n,cp2y:i,x:r,y:o}),this.currentX_=r,this.currentY_=o},w.quadraticCurveTo=function(t,e,n,i){var r=this.currentX_+2/3*(t-this.currentX_),o=this.currentY_+2/3*(e-this.currentY_),a=r+(n-this.currentX_)/3,s=o+(i-this.currentY_)/3;this.bezierCurveTo(r,o,a,s,n,i)},w.arc=function(t,e,n,i,r,o){n*=f;var a=o?"at":"wa",s=t+d(i)*n-m,u=e+p(i)*n-m,l=t+d(r)*n-m,c=e+p(r)*n-m;s!=l||o||(s+=.125),this.currentPath_.push({type:a,x:t,y:e,radius:n,xStart:s,yStart:u,xEnd:l,yEnd:c})},w.rect=function(t,e,n,i){this.moveTo(t,e),this.lineTo(t+n,e),this.lineTo(t+n,e+i),this.lineTo(t,e+i),this.closePath()},w.strokeRect=function(t,e,n,i){this.beginPath(),this.moveTo(t,e),this.lineTo(t+n,e),this.lineTo(t+n,e+i),this.lineTo(t,e+i),this.closePath(),this.stroke()},w.fillRect=function(t,e,n,i){this.beginPath(),this.moveTo(t,e),this.lineTo(t+n,e),this.lineTo(t+n,e+i),this.lineTo(t,e+i),this.closePath(),this.fill()},w.createLinearGradient=function(){var t=new u("gradient");return t},w.createRadialGradient=function(t,e,n,i,r,o){var a=new u("gradientradial");return a.radius1_=n,a.radius2_=o,a.focus_.x=t,a.focus_.y=e,a},w.drawImage=function(t){var e,n,i,r,o,a,s,u,l=t.runtimeStyle.width,c=t.runtimeStyle.height;t.runtimeStyle.width="auto",t.runtimeStyle.height="auto";var p=t.width,d=t.height;if(t.runtimeStyle.width=l,t.runtimeStyle.height=c,3==arguments.length)e=arguments[1],n=arguments[2],o=a=0,s=i=p,u=r=d;else if(5==arguments.length)e=arguments[1],n=arguments[2],i=arguments[3],r=arguments[4],o=a=0,s=p,u=d;else{if(9!=arguments.length)throw"Invalid number of arguments";o=arguments[1],a=arguments[2],s=arguments[3],u=arguments[4],e=arguments[5],n=arguments[6],i=arguments[7],r=arguments[8]}var m=this.getCoords_(e,n),g=[],v=10,y=10;if(g.push(" <g_vml_:group",' coordsize="',f*v,",",f*y,'"',' coordorigin="0,0"',' style="width:',v,";height:",y,";position:absolute;"),1!=this.m_[0][0]||this.m_[0][1]){var b=[];b.push("M11='",this.m_[0][0],"',","M12='",this.m_[1][0],"',","M21='",this.m_[0][1],"',","M22='",this.m_[1][1],"',","Dx='",h(m.x/f),"',","Dy='",h(m.y/f),"'");var w=m,x=this.getCoords_(e+i,n),_=this.getCoords_(e,n+r),C=this.getCoords_(e+i,n+r);w.x=Math.max(w.x,x.x,_.x,C.x),w.y=Math.max(w.y,x.y,_.y,C.y),g.push("padding:0 ",h(w.x/f),"px ",h(w.y/f),"px 0;filter:progid:DXImageTransform.Microsoft.Matrix(",b.join(""),", sizingmethod='clip');")}else g.push("top:",h(m.y/f),"px;left:",h(m.x/f),"px;");g.push(' ">','<g_vml_:image src="',t.src,'"',' style="width:',f*i,";"," height:",f*r,';"',' cropleft="',o/p,'"',' croptop="',a/d,'"',' cropright="',(p-o-s)/p,'"',' cropbottom="',(d-a-u)/d,'"'," />","</g_vml_:group>"),this.element_.insertAdjacentHTML("BeforeEnd",g.join(""))},w.stroke=function(t){var e=[],n=o(t?this.fillStyle:this.strokeStyle),i=n[0],r=n[1]*this.globalAlpha,s=10,u=10;e.push("<g_vml_:shape",' fillcolor="',i,'"',' filled="',Boolean(t),'"',' style="position:absolute;width:',s,";height:",u,';"',' coordorigin="0 0" coordsize="',f*s," ",f*u,'"',' stroked="',!t,'"',' strokeweight="',this.lineWidth,'"',' strokecolor="',i,'"',' path="');for(var l={x:null,y:null},c={x:null,y:null},p=0;p<this.currentPath_.length;p++){var d=this.currentPath_[p];if("moveTo"==d.type){e.push(" m ");var m=this.getCoords_(d.x,d.y);e.push(h(m.x),",",h(m.y))}else if("lineTo"==d.type){e.push(" l ");var m=this.getCoords_(d.x,d.y);e.push(h(m.x),",",h(m.y))}else if("close"==d.type)e.push(" x ");else if("bezierCurveTo"==d.type){e.push(" c ");var m=this.getCoords_(d.x,d.y),g=this.getCoords_(d.cp1x,d.cp1y),v=this.getCoords_(d.cp2x,d.cp2y);e.push(h(g.x),",",h(g.y),",",h(v.x),",",h(v.y),",",h(m.x),",",h(m.y))}else if("at"==d.type||"wa"==d.type){e.push(" ",d.type," ");var m=this.getCoords_(d.x,d.y),y=this.getCoords_(d.xStart,d.yStart),b=this.getCoords_(d.xEnd,d.yEnd);e.push(h(m.x-this.arcScaleX_*d.radius),",",h(m.y-this.arcScaleY_*d.radius)," ",h(m.x+this.arcScaleX_*d.radius),",",h(m.y+this.arcScaleY_*d.radius)," ",h(y.x),",",h(y.y)," ",h(b.x),",",h(b.y))}m&&((null==l.x||m.x<l.x)&&(l.x=m.x),(null==c.x||m.x>c.x)&&(c.x=m.x),(null==l.y||m.y<l.y)&&(l.y=m.y),(null==c.y||m.y>c.y)&&(c.y=m.y))}if(e.push(' ">'),"object"==typeof this.fillStyle){var w={x:"50%",y:"50%"},x=c.x-l.x,_=c.y-l.y,C=x>_?x:_;w.x=h(this.fillStyle.focus_.x/x*100+50)+"%",w.y=h(this.fillStyle.focus_.y/_*100+50)+"%";var k=[];if("gradientradial"==this.fillStyle.type_)var E=this.fillStyle.radius1_/C*100,S=this.fillStyle.radius2_/C*100-E;else var E=0,S=100;var M={offset:null,color:null},T={offset:null,color:null};this.fillStyle.colors_.sort(function(t,e){return t.offset-e.offset});for(var p=0;p<this.fillStyle.colors_.length;p++){var D=this.fillStyle.colors_[p];k.push(D.offset*S+E,"% ",D.color,","),(D.offset>M.offset||null==M.offset)&&(M.offset=D.offset,M.color=D.color),(D.offset<T.offset||null==T.offset)&&(T.offset=D.offset,T.color=D.color)}k.pop(),e.push("<g_vml_:fill",' color="',T.color,'"',' color2="',M.color,'"',' type="',this.fillStyle.type_,'"',' focusposition="',w.x,", ",w.y,'"',' colors="',k.join(""),'"',' opacity="',r,'" />')}else t?e.push('<g_vml_:fill color="',i,'" opacity="',r,'" />'):e.push("<g_vml_:stroke",' opacity="',r,'"',' joinstyle="',this.lineJoin,'"',' miterlimit="',this.miterLimit,'"',' endcap="',a(this.lineCap),'"',' weight="',this.lineWidth,'px"',' color="',i,'" />');e.push("</g_vml_:shape>"),this.element_.insertAdjacentHTML("beforeEnd",e.join("")),this.currentPath_=[]},w.fill=function(){this.stroke(!0)},w.closePath=function(){this.currentPath_.push({type:"close"})},w.getCoords_=function(t,e){return{x:f*(t*this.m_[0][0]+e*this.m_[1][0]+this.m_[2][0])-m,y:f*(t*this.m_[0][1]+e*this.m_[1][1]+this.m_[2][1])-m}},w.save=function(){var t={};r(this,t),this.aStack_.push(t),this.mStack_.push(this.m_),this.m_=i(n(),this.m_)},w.restore=function(){r(this.aStack_.pop(),this),this.m_=this.mStack_.pop()},w.translate=function(t,e){var n=[[1,0,0],[0,1,0],[t,e,1]];this.m_=i(n,this.m_)},w.rotate=function(t){var e=d(t),n=p(t),r=[[e,n,0],[-n,e,0],[0,0,1]];this.m_=i(r,this.m_)},w.scale=function(t,e){this.arcScaleX_*=t,this.arcScaleY_*=e;var n=[[t,0,0],[0,e,0],[0,0,1]];this.m_=i(n,this.m_)},w.clip=function(){},w.arcTo=function(){},w.createPattern=function(){return new l},u.prototype.addColorStop=function(t,e){e=o(e),this.colors_.push({offset:1-t,color:e})},G_vmlCanvasManager=g,CanvasRenderingContext2D=s,CanvasGradient=u,CanvasPattern=l}();