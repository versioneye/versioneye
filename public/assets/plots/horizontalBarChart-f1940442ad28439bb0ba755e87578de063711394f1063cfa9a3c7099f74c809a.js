define([require],function(t){function e(t){this.selector=t.selector||"body",this.height=t.height||400,this.width=t.width||680,this.margin={top:10,right:20,bottom:12,left:80},this.canvasWidth=this.width-this.margin.left-this.margin.right,this.canvasHeight=this.height-this.margin.top-this.margin.bottom,this.fontSize=t.fontSize||10,this.dataset=t.dataset||[],this.title=t.title||"",this.xScaler=d3.scale.linear().range([0,this.canvasWidth]),this.yScaler=d3.scale.ordinal().rangeRoundBands([0,this.canvasHeight],.2)}function n(t){return d3.svg.axis().scale(t.xScaler).orient("bottom").ticks(5)}return e.prototype.loadAndRender=function(t){var e=this;d3.json(t,function(n,r){return n?(console.error("Can not load data from: "+t),1):(r.forEach(function(t){t.value=+t.value}),r.sort(function(t,e){return t.value>=e.value?-1:1}),void e.render(r))})},e.prototype.render=function(t){var e=this;e.dataset=t,e.xScaler.domain([0,d3.max(t,function(t){return t.value})]),e.yScaler.domain(t.map(function(t){return t.name})),canvas=e.initCanvas(e.selector),canvas.select("g").selectAll(".bar").data(t).enter().append("rect").attr({"class":"bar",x:function(t){return 0},y:function(t){return e.yScaler(t.name)},width:function(t){return e.xScaler(t.value)},height:e.yScaler.rangeBand()}),e.addBarLabels(),e.addBarTitles(),e.addAxisX(),e.addTitle(e.title||"")},e.prototype.initCanvas=function(t){var e=this,n=d3.select(t).append("svg").attr({width:e.width,height:e.height});return n.append("g").attr("transform","translate("+e.margin.left+","+e.margin.top+")"),e.canvas=n,n},e.prototype.addBarLabels=function(){var t=this;t.canvas.select("g").selectAll("text").data(t.dataset).enter().append("text").text(function(t){return t.value}).attr({x:function(e){return t.xScaler(e.value)-t.fontSize*String(e.value).length},y:function(e){return t.yScaler(e.name)+t.yScaler.rangeBand()/1.8},fill:"white"})},e.prototype.addBarTitles=function(){var t=this,e=t.canvas.append("g");e.attr("transform","translate(0, "+t.margin.top+")").selectAll("text").data(t.dataset).enter().append("text").text(function(t){return t.name}).attr({"class":"barTitle",x:function(t){return 0},y:function(e){return t.yScaler(e.name)+t.yScaler.rangeBand()/1.8}})},e.prototype.addAxisX=function(){var t=this;t.canvas.append("g").attr("class","grid").attr("transform","translate("+t.margin.left+","+t.canvasHeight+")").call(n(t).tickSize(-t.canvasHeight+t.margin.top,0,0).tickFormat(function(t){return t}))},e.prototype.addTitle=function(t){var e=this;e.canvas.append("g").attr("class","").append("text").text(t).attr({"class":"plotTitle",x:function(t){return e.width/2},y:function(t){return e.margin.top+5}})},e});