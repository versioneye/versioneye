
<div class="row" >

  <div class="flash info" style="margin-bottom: 5px;" >
    <b>Current:</b>
    <% if @current_version && !@current_version.version.eql?(@product.version) %>
      <a href="/<%= @product.language_esc %>/<%= @product.to_param %>/<%= @current_version.version %>" ><%= @current_version.version %></a>
    <% else %>
      <%= @current_version.version %>
    <% end %>
  </div>

  <div class="flash info" style="margin-bottom: 5px;">
    <b>This:</b> <%= @product.version %>
  </div>

  <% last_date = nil %>
  <% time_in_words = nil %>
  <% rel_text = "info" %>
  <% days_ago = @product.released_days_ago %>
  <% if @product.released_days_ago %>
    <% last_date = Date.today - @product.released_days_ago %>
    <% time_in_words = distance_of_time_in_words(Date.today, last_date) %>
    <% rel_text = "This artifact was released #{time_in_words} ago on #{@version.created_at.strftime("%b %d, %Y - %I:%m %p")}" %>
  <% else %>
    <% last_date = DateTime.now.to_date - @product.created_at.to_date %>
    <% time_in_words = distance_of_time_in_words(Date.today, @version.created_at) %>
    <% days_ago = last_date.to_i %>
    <% rel_text = "We don't have any information about the release date of this artifact, but we detected it #{time_in_words} ago on #{@version.created_at.strftime("%b %d, %Y - %I:%m %p")}" %>
  <% end %>
  <% rel_bg = "success" if days_ago < 30  %>
  <% rel_bg = "info"        if days_ago >= 30 && days_ago <= 90  %>
  <% rel_bg = "warn"    if days_ago > 90  && days_ago <= 180  %>
  <% rel_bg = "error"   if days_ago > 180 %>
  <div class="flash <%= rel_bg %>" style="margin-bottom: 5px;" >
    <b title="<%= rel_text %>" >Released:</b>
    <span title="<%= rel_text %>">
      <% if time_in_words.nil? %>
        N/A
      <% else %>
        <%= time_in_words %> ago
      <% end %>
    </span>
  </div>

  <% average_release_time = VersionService.average_release_time( @product.versions ) %>
  <% if average_release_time.nil? %>
    <% average_release_time = VersionService.estimated_average_release_time( @product.versions ) %>
  <% end %>
  <% art_bg = "info" if average_release_time == 0  %>
  <% art_bg = "success" if average_release_time > 0 && average_release_time <= 31  %>
  <% art_bg = "info"  if average_release_time > 31 && average_release_time <= 62  %>
  <% art_bg = "warn"  if average_release_time > 62 && average_release_time <= 124  %>
  <% art_bg = "error" if average_release_time > 124 %>
  <% art_text = "In average this dev team is releasing a new version every #{average_release_time} days." %>
  <% art_text = "Not Available" if average_release_time == 0 %>
  <div class="flash <%= art_bg %>" style="margin-bottom: 5px;" >
    <b title="<%= art_text %>" >Avg. Rel. Time:</b>
    <span title="<%= art_text %>">
      <% if average_release_time == 0 %>
       N/A
      <% else %>
        <%= average_release_time %> days
      <% end %>
    </span>
  </div>

  <% references = @product.used_by_count %>
  <% ref_bg = "success" if references >= 500  %>
  <% ref_bg = "info"      if references >= 100 and references < 500  %>
  <% ref_bg = "warn"  if references > 0 and references < 100  %>
  <% ref_bg = "error" if references == 0 %>
  <% ref_text = "#{references} artifacts are referencing this project" %>
  <div class="flash <%= ref_bg %>" style="margin-bottom: 5px;" >
    <b title="<%= ref_text %>">References:</b> <span title="<%= ref_text %>"><%= references %></span>
  </div>

  <% main_dep_count = @product.dependencies(nil).count %>
  <% dep_bg = "success" if main_dep_count <= 9  %>
  <% dep_bg = "info" if main_dep_count > 9 and main_dep_count < 15  %>
  <% dep_bg = "warn" if main_dep_count >= 15 and main_dep_count < 30  %>
  <% dep_bg = "error" if main_dep_count >= 30 %>
  <% scope = Dependency.main_scope(@product.language) %>
  <% title_text = "#{main_dep_count} direct #{scope} dependencies" %>
  <div class="flash <%= dep_bg %>" style="margin-bottom: 5px;">
    <b title="<%= title_text %>">Dependencies:</b> <span title="<%= title_text %>"><%= main_dep_count %></span>
  </div>

</div>
