<% title 'Projects' %>

<div class="col-md-3" >
  <%= render '/user/helpers/navi' %>
</div>

<div class="col-md-9">

  <div class="content_header_def" >
    VersionEye is watching <b><%= pluralize( @projects.size, "Project" ) %></b> for you.
  </div>

  <div class="content" >
    <div id='projects_filter' >
      <form id="form" action="/user/projects" method="GET" class='form-inline' style="padding: 0; margin:0;" >

        <div class="form-group" style="padding-bottom: 25px;">
          <%= text_field_tag :name, params[:name], :id => "name", :class => 'form-control', :placeholder => 'project name' %>
          <select name="language"  id="language" class="form-control" >
            <option value="ALL"  >ALL</option>
            <% LanguageService.distinct_languages.sort.each do |language| %>
              <option value="<%= language %>" <%= "selected" if params[:language].to_s.eql?(language) %> ><%= language %></option>
            <% end %>
          </select>
          <select name="scope"  id="scope" class="form-control" >
            <option value="user"  >My own projects</option>
            <option value="all_public" <%= 'selected' if params[:scope].to_s.eql?('all_public') %> >All public projects</option>
            <% if current_user.admin == true %>
              <option value="all" <%= 'selected' if params[:scope].to_s.eql?('all') %> >All projects</option>
            <% end %>
          </select>
          <button type="submit" class="btn btn-primary" >Filter</button>
        </div>

      </form>
    </div>
    <div id="projects" >
      <table class="table table-striped" style="width: 100%">
        <colgroup>
          <col width="35px;"j />
          <col width="*" />
          <col width="*" />
          <col width="*" />
        </colgroup>
        <thead>
          <tr>
            <th></th>
            <th><a href="/user/projects?name=<%=params[:name]%>&amp;language=<%= params[:language] %>&amp;scope=<%=params[:scope]%>&amp;sort=name">Projects</a></th>
            <th><a href="/user/projects?name=<%=params[:name]%>&amp;language=<%= params[:language] %>&amp;scope=<%=params[:scope]%>&amp;sort=out_dated">Versions</a></th>
            <th><a href="/user/projects?name=<%=params[:name]%>&amp;language=<%= params[:language] %>&amp;scope=<%=params[:scope]%>&amp;sort=license_violations">Licenses</a></th>
          </tr>
        </thead>
        <%= render partial: "/user/projects/helpers/project" , collection: @projects %>
      </table>
    </div>
  </div>

</div>

<script type="text/javascript">
  function show_project_filter(){
    document.getElementById('projects_filter_link').style.display = 'none';
    document.getElementById('projects_filter').style.display = 'inline';
    return false;
  }
  function hide_project_filter(){
    document.getElementById('projects_filter_link').style.display = 'inline';
    document.getElementById('projects_filter').style.display = 'none';
    return false;
  }
</script>
